<?php
include 'config/db.php';
?>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>StoryHive Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700;800&display=swap" rel="stylesheet">
  <style>
    body { margin:0; font-family:'DM Sans', sans-serif; background:#f8f8f8; color:#333; }
    
    .navbar { background:#fff; border-bottom:1px solid #ddd; position:sticky; top:0; z-index:999; }
    .navbar .container { max-width:1100px; margin:0 auto; display:flex; align-items:center; justify-content:space-between; padding:10px 15px; flex-wrap:wrap; }
    .navbar-brand a { font-weight:bold; font-size:22px; color:#0d6efd; text-decoration:none; }
    .nav-links { display:flex; gap:25px; justify-content:center; flex:1; }
    .nav-links a { text-decoration:none; color:#000; font-weight:500; transition:0.2s; }
    .nav-links a:hover { color:#0d6efd; }
    .dropdown { position:relative; }
    .dropdown-content { display:none; position:absolute; top:100%; left:0; background:#fff; border:1px solid #ddd; border-radius:6px; overflow:hidden; min-width:120px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .dropdown-content a { display:block; padding:8px 12px; text-decoration:none; color:#000; font-size:14px; }
    .dropdown-content a:hover { background:#f1f1f1; color:#0d6efd; }
    .search-form input { padding:6px 12px; border-radius:50px; border:1px solid #ccc; font-size:14px; line-height:1; }
   
    .navbar, .navbar .container, .navbar-brand a, .nav-links a { line-height:1; }
    .hero { text-align:center; padding:80px 20px 60px; background:#000; color:#fff; }
    .hero h1 { font-size:36px; margin-bottom:15px; }
    .hero h1 span { color:#0d6efd; }
    .hero p { font-size:16px; color:#ccc; max-width:600px; margin:0 auto; }

    .blog-section { max-width:1100px; margin:60px auto; padding:0 15px; }
    .section-header { display:flex; justify-content:space-between; align-items:end; border-bottom:1px solid #ddd; padding-bottom:10px; margin-bottom:25px; }
    .section-header h2 { margin:0; font-size:24px; }
    .section-header p { margin:0; color:#666; font-size:14px; }
    .section-header a { text-decoration:none; color:#0d6efd; font-weight:500; font-size:14px; }
    
    .blog-row { display:flex; gap:20px; flex-wrap:wrap; }
    .blog-card { background:#fff; border-radius:8px; overflow:hidden; width:calc(33.333% - 13.33px); box-shadow:0 2px 6px rgba(0,0,0,0.05); display:flex; flex-direction:column; transition:0.3s; text-decoration:none; color:inherit; }
    .blog-card img { width:100%; height:180px; object-fit:cover; }
    .card-body { padding:12px; flex:1; display:flex; flex-direction:column; }
    .card-body small { color:#666; font-size:12px; }
    .card-body h5 { margin:6px 0; font-size:16px; }
    .card-body p { color:#555; font-size:14px; flex:1; margin:0 0 8px 0; }
    .card-body a { text-decoration:none; color:#0d6efd; font-weight:500; font-size:14px; }

    footer { background:#fff; border-top:1px solid #ccc; padding:40px 15px 20px 15px; color:#666; font-size:14px; }
    footer .footer-container { max-width:1200px; margin:0 auto; display:flex; flex-wrap:wrap; gap:20px; }
    footer .footer-column { flex:1; min-width:180px; }
    footer h5, footer h6 { margin-bottom:10px; font-weight:700; color:#333; }
    footer a { text-decoration:none; color:#007bff; }
    footer .copyright { text-align:center; margin-top:20px; }

    @media(max-width:900px){ .blog-card{width:calc(50% - 10px);} }
    @media(max-width:600px){ .blog-card{width:100%;} .nav-links{order:3; width:100%; justify-content:center; margin-top:10px;} .search-form{order:2;} }
  </style>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<?php include 'navbar.php'; ?>

<div class="hero">
  <h1>Stories that <span>Inspire</span></h1>
  <p>Discover thoughtful writing on technology, lifestyle, and modern culture, curated just for you.</p>
</div>

<?php
// Define categories
$categories = ['Food'=>'food','Tech'=>'tech','Travel'=>'travel'];

// Loop through categories and display latest 3 blogs
foreach($categories as $catName=>$catClass){
    echo '<div class="blog-section">
      <div class="section-header">
        <div><h2>'.$catName.' Blog</h2><p>Latest stories in '.$catName.'</p></div>
        <a href="category.php?cat='.$catName.'">View All &rarr;</a>
      </div>
      <div class="blog-row">';

    $stmt = $conn->prepare("SELECT * FROM blogs WHERE category=? ORDER BY date DESC LIMIT 3");
    $stmt->bind_param("s",$catName);
    $stmt->execute();
    $result = $stmt->get_result();

    if($result && $result->num_rows>0){
        while($row = $result->fetch_assoc()){
            echo '<a class="blog-card" href="blog.php?id='.urlencode($row['id']).'">
                  <div style="position:relative;">
                    <img src="'.htmlspecialchars($row['image']).'" alt="'.htmlspecialchars($row['title']).'">
                    <span class="badge '.$catClass.'">'.$catName.'</span>
                  </div>
                  <div class="card-body">
                    <small>'.htmlspecialchars($row['date']).'</small>
                    <h5>'.htmlspecialchars($row['title']).'</h5>
                    <p>'.htmlspecialchars(substr($row['content'],0,100)).'...</p>
                  </div>
                </a>';
        }
    } else {
        echo '<p style="font-size:16px; color:#555; margin-left:15px;">No Blog Found</p>';
    }

    echo '</div></div>';
}
?>

<footer>
  <div class="footer-container">
    <div class="footer-column">
      <h5>StoryHive</h5>
      <p>Stories that inspire modern creators.</p>
    </div>
    <div class="footer-column">
      <h6>Company</h6>
      <ul>
        <li>Terms & Conditions</li>
        <li>Privacy Policy</li>
        <li>FAQs</li>
      </ul>
    </div>
    <div class="footer-column">
      <h6>Help</h6>
      <ul>
        <li>Getting Started</li>
        <li>Feedback</li>
        <li>Support</li>
      </ul>
    </div>
    <div class="footer-column">
      <h6>Contact</h6>
      <p>Email: StoryHive@gmail.com<br>Phone: +92-000-000000</p>
    </div>
  </div>
  <div class="copyright">
    Â© 2026 StoryHive Blog
  </div>
</footer>
</body>
</html>
